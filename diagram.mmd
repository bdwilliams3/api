graph TD
    %% System Identification
    subgraph External["fa:fa-globe Internet"]
        User((fa:fa-user User))
    end
    subgraph Cluster["fa:fa-dharmachakra Kind Cluster"]
        direction TB
        subgraph Entry["fa:fa-door-open Entry Points"]
            GW_api-gateway["fa:fa-door-open Gateway: api-gateway"]\n            GW_api-gateway["fa:fa-door-open Gateway: api-gateway"]\n        end
        subgraph Services["fa:fa-link Network Services"]
            SVC_falco-falcosidekick["fa:fa-share-alt Svc: falco-falcosidekick"]\n            SVC_k-api-service["fa:fa-share-alt Svc: k-api-service"]\n            SVC_kubernetes["fa:fa-share-alt Svc: kubernetes"]\n            SVC_grafana["fa:fa-share-alt Svc: grafana"]\n            SVC_istio-ingressgateway["fa:fa-share-alt Svc: istio-ingressgateway"]\n            SVC_istiod["fa:fa-share-alt Svc: istiod"]\n            SVC_loki["fa:fa-share-alt Svc: loki"]\n            SVC_loki-headless["fa:fa-share-alt Svc: loki-headless"]\n            SVC_loki-memberlist["fa:fa-share-alt Svc: loki-memberlist"]\n            SVC_prometheus["fa:fa-share-alt Svc: prometheus"]\n            SVC_kube-dns["fa:fa-share-alt Svc: kube-dns"]\n            SVC_loki-stack["fa:fa-share-alt Svc: loki-stack"]\n            SVC_loki-stack-headless["fa:fa-share-alt Svc: loki-stack-headless"]\n            SVC_loki-stack-memberlist["fa:fa-share-alt Svc: loki-stack-memberlist"]\n        end
        subgraph Workloads["fa:fa-microchip Pods & Sidecars"]
            subgraph POD_breach_test["Pod: breach_test"]\n                C_breach_test_["fa:fa_box breach_test"]\n                C_istio_proxy_["fa:fa_box istio_proxy"]\n            end\n            subgraph POD_falco_f4ts2["Pod: falco_f4ts2"]\n                C_falco_["fa:fa_box falco"]\n                C_falcoctl_artifact_follow_["fa:fa_box falcoctl_artifact_follow"]\n                C_istio_proxy_["fa:fa_box istio_proxy"]\n            end\n            subgraph POD_falco_falcosidekick_7b7dbbd79_kk99g["Pod: falco_falcosidekick_7b7dbbd79_kk99g"]\n                C_falcosidekick_["fa:fa_box falcosidekick"]\n                C_istio_proxy_["fa:fa_box istio_proxy"]\n            end\n            subgraph POD_falco_falcosidekick_7b7dbbd79_p7f8b["Pod: falco_falcosidekick_7b7dbbd79_p7f8b"]\n                C_falcosidekick_["fa:fa_box falcosidekick"]\n                C_istio_proxy_["fa:fa_box istio_proxy"]\n            end\n            subgraph POD_k_api_5b5ffc84b8_mnfcw["Pod: k_api_5b5ffc84b8_mnfcw"]\n                C_k_api_["fa:fa_box k_api"]\n                C_istio_proxy_["fa:fa_box istio_proxy"]\n            end\n            subgraph POD_k_api_5b5ffc84b8_zcjsf["Pod: k_api_5b5ffc84b8_zcjsf"]\n                C_k_api_["fa:fa_box k_api"]\n                C_istio_proxy_["fa:fa_box istio_proxy"]\n            end\n            subgraph POD_grafana_7874f88995_cn5hl["Pod: grafana_7874f88995_cn5hl"]\n                C_grafana_["fa:fa_box grafana"]\n            end\n            subgraph POD_istio_ingressgateway_84f78c778b_tqkmd["Pod: istio_ingressgateway_84f78c778b_tqkmd"]\n                C_istio_proxy_["fa:fa_box istio_proxy"]\n            end\n            subgraph POD_istiod_67b9cf4965_s6hlr["Pod: istiod_67b9cf4965_s6hlr"]\n                C_discovery_["fa:fa_box discovery"]\n            end\n            subgraph POD_loki_0["Pod: loki_0"]\n                C_loki_sc_rules_["fa:fa_box loki_sc_rules"]\n                C_loki_["fa:fa_box loki"]\n            end\n            subgraph POD_prometheus_86f99d868_9q566["Pod: prometheus_86f99d868_9q566"]\n                C_prometheus_server_configmap_reload_["fa:fa_box prometheus_server_configmap_reload"]\n                C_prometheus_server_["fa:fa_box prometheus_server"]\n            end\n            subgraph POD_coredns_5d78c9869d_dhbm6["Pod: coredns_5d78c9869d_dhbm6"]\n                C_coredns_["fa:fa_box coredns"]\n            end\n            subgraph POD_coredns_5d78c9869d_vddpg["Pod: coredns_5d78c9869d_vddpg"]\n                C_coredns_["fa:fa_box coredns"]\n            end\n            subgraph POD_etcd_api_cluster_control_plane["Pod: etcd_api_cluster_control_plane"]\n                C_etcd_["fa:fa_box etcd"]\n            end\n            subgraph POD_kindnet_bb4j5["Pod: kindnet_bb4j5"]\n                C_kindnet_cni_["fa:fa_box kindnet_cni"]\n            end\n            subgraph POD_kube_apiserver_api_cluster_control_plane["Pod: kube_apiserver_api_cluster_control_plane"]\n                C_kube_apiserver_["fa:fa_box kube_apiserver"]\n            end\n            subgraph POD_kube_controller_manager_api_cluster_control_plane["Pod: kube_controller_manager_api_cluster_control_plane"]\n                C_kube_controller_manager_["fa:fa_box kube_controller_manager"]\n            end\n            subgraph POD_kube_proxy_mbt7w["Pod: kube_proxy_mbt7w"]\n                C_kube_proxy_["fa:fa_box kube_proxy"]\n            end\n            subgraph POD_kube_scheduler_api_cluster_control_plane["Pod: kube_scheduler_api_cluster_control_plane"]\n                C_kube_scheduler_["fa:fa_box kube_scheduler"]\n            end\n            subgraph POD_local_path_provisioner_6bc4bddd6b_fgvtn["Pod: local_path_provisioner_6bc4bddd6b_fgvtn"]\n                C_local_path_provisioner_["fa:fa_box local_path_provisioner"]\n            end\n            subgraph POD_loki_69cc446978_k78z4["Pod: loki_69cc446978_k78z4"]\n                C_loki_["fa:fa_box loki"]\n            end\n            subgraph POD_promtail_gwdxg["Pod: promtail_gwdxg"]\n                C_promtail_["fa:fa_box promtail"]\n            end\n        end
        subgraph Security["fa:fa-shield-alt Security Stack"]
            Falco_DS[fa:fa-user-secret Falco DaemonSet]
            Sidekick[fa:fa-comment-dots Falcosidekick]
            Loki_DB[(fa:fa-database Loki DB)]
        end
    end
    %% Traffic Flow
    User --> CF[fa:fa-cloud Cloudflare Tunnel]
    CF --> GW_istio-gateway
    SVC_falco_falcosidekick _._> POD_\n    SVC_k_api_service _._> POD_k_api\n    SVC_kubernetes _._> POD_\n    SVC_grafana _._> POD_\n    SVC_istio_ingressgateway _._> POD_istio_ingressgateway\n    SVC_istiod _._> POD_istiod\n    SVC_loki _._> POD_\n    SVC_loki_headless _._> POD_\n    SVC_loki_memberlist _._> POD_\n    SVC_prometheus _._> POD_\n    SVC_kube_dns _._> POD_\n    SVC_loki_stack _._> POD_loki\n    SVC_loki_stack_headless _._> POD_loki\n    SVC_loki_stack_memberlist _._> POD_loki\n
    %% Security Observability
    Workloads -. syscalls .-> Falco_DS
    Falco_DS --> Sidekick
    Sidekick --> Loki_DB
